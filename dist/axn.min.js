/*! axn js - v0.1.0 - 2013-06-07
* https://github.com/otterthecat/axnjs
* Copyright (c) 2013 Otter the Cat; Licensed MIT, GPL */
(function(){var t="0.02",n={data_name:"axn",root_selector:null,jsonp_callback:"callback",dom_ready_callback:function(){}},e=function(){this.name="",this.params="",this.evt="",this.element={},this.jsonp="",this.bindings=[]};e.prototype={setValues:function(t){this.name=t.name,this.params=t.params,this.evt=t.evt,this.element=t.element,this.jsonp=t.jsonp,this.bindings=t.bindings}};var r=function(t){if(t.hasOwnProperty("ajax"))return t;var n={};return window.XMLHttpRequest?n=new XMLHttpRequest:window.ActiveXObject&&(n=new window.ActiveXObject("Microsoft.XMLHTTP")),t.hasOwnProperty("prototype")?t.prototype.ajax=n:t.ajax=n,t},a=/:?[a-zA-Z0-9\-_.\/\?=\!\&]+/g,o=/[a-zA-Z\-_]+/,i={},s={},c={},u={},f=function(t,n){if("object"==typeof t&&"object"==typeof n){for(var e in t)t[e]=n[e];return t}return!1},p=function(t){document.onreadystatechange=function(){"complete"===document.readyState&&(h(n.root_selector),"function"==typeof t&&t(),m())}},l=function(t,n){t.evt?t.element.addEventListener(t.evt,function(e){t.jsonp?b(t,n):(n.call(t.element,t.params,e),t.bindings.length>0&&d(t.bindings[0][0].name,t.params))},!1):t.jsonp?b(t,n):(n.call(t.element,t.params),t.bindings.length>0&&d(t.bindings[0][0].name,t.params))},d=function(t,n,e){for(var r="boolean"==typeof e&&e===!0,a=s[t],o=0;a.length>o;o+=1)f(s[t][o].params,n),"string"==typeof s[t][o].jsonp&&r?b(s[t][o],i[t]):r&&i[t].call(s[t][o].element,s[t][o].params)},m=function(){for(var t in s)if(i.hasOwnProperty(t))for(var n=0;s[t].length>n;n+=1)l(s[t][n],i[t],s[t][n].bindings)},h=function(t){var n;return n="string"==typeof t?document.querySelectorAll(t):document.querySelectorAll("*"),g(n)},g=function(t){for(var a=0;t.length>a;a+=1)if(t[a].hasAttribute("data-"+n.data_name)){var o=t[a],i=o.getAttribute("data-"+n.data_name);s.hasOwnProperty(i)||(s[i]=[]);var c=new e;c.setValues({name:i,params:y(o),evt:v(o,"event"),element:r(o),jsonp:v(o,"jsonp"),bindings:[]}),s[i].push(c)}return s},y=function(t){var e={},r=t.getAttribute("data-"+n.data_name+"-params");if("string"==typeof r)for(var o=r.split(","),i=0;o.length>i;i+=1){var s=o[i].match(a),u=s.shift();e[u]=s.join(" ")}return c[t.getAttribute("data-"+n.data_name)]=e,e},v=function(t,e){var r=t.getAttribute("data-"+n.data_name+"-"+e);return r||null},b=function(t,e){var r=document.createElement("script");r.src=t.jsonp+"&"+n.jsonp_callback+"="+t.name,window[t.name]=function(n){e.call(t.element,n,t.params),delete window[t.name]},document.getElementsByTagName("body")[0].appendChild(r)},w=function(t,n){return i.hasOwnProperty(t)?(window.console.error("AXN _fn object already has property ["+t+"]"),!1):(i[t]=n,void 0)},j=function(t,n){for(var e=0;n.length>e;e+=1)s[t][0].bindings.push(n);u={}},A=function(){};return A.prototype={version:t,add:function(t,n){return w(t,n),this},bind:function(t){if("string"!=typeof t)return!1;var n=t.match(o);return u=this.getActions(n),this},to:function(t,n){w(t,n),j(t,u)},ready:function(t){p(t)},configure:function(t){return"object"==typeof t?f(n,t):window.console.error("AXN.config() requires object literal"),this},getActions:function(t){return s.hasOwnProperty(t)?s[t]:s},getFunctions:function(t){return i.hasOwnProperty(t)?i[t]:i},getStoredData:function(t){return c.hasOwnProperty(t)?c[t]:c},getConfig:function(){return n},exec:function(){m()}},window.AXN=A})();